name: Supabase Keep Alive

on:
  schedule:
    # Runs at 00:00 UTC every day.
    - cron: '0 0 * * *'
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    env:
      VITE_SUPABASE_URL: ${{ secrets.VITE_SUPABASE_URL }}
    steps:
      - name: Ping Supabase Project
        if: env.VITE_SUPABASE_URL != ''
        run: |
          echo "Pinging Supabase project to prevent pausing..."
          curl -fsS --head "${VITE_SUPABASE_URL}/rest/v1/" || true
          echo "Ping complete."

      - name: Warning if Secret Missing
        if: env.VITE_SUPABASE_URL == ''
        run: |
          echo "::warning::VITE_SUPABASE_URL secret is not set. The keep-alive ping will not work."
          echo "Please go to Repository Settings -> Secrets and variables -> Actions and add 'VITE_SUPABASE_URL'."
